## MCP 기능 사용 설명

### 기능 개요
- MCP(Model Context Protocol)는 WeKnora가 외부 도구나 데이터 소스를 안전하게 연결하여, Agent 추론 시 호출할 수 있는 기능을 확장할 수 있게 합니다.
- 프론트엔드의 `설정 > MCP 서비스`(`frontend/src/views/settings/McpSettings.vue`)에서 모든 서비스를 중앙에서 관리하며, 수동으로 설정 파일을 수정할 필요가 없습니다.
- 각 서비스에는 이름, 전송 방식(SSE / HTTP Streamable / Stdio), 연결 주소 또는 명령어, 인증 정보 및 고급 타임아웃/재시도 정책이 포함됩니다.

### 진입점 및 인터페이스
- 콘솔 왼쪽 메뉴에서 `설정 -> MCP 서비스`를 열면 현재 테넌트의 모든 MCP 서비스 목록을 볼 수 있습니다.
- 목록에서 서비스를 빠르게 시작/중지하고, 설명을 확인하며, 오른쪽 메뉴를 통해 "테스트 / 편집 / 삭제"를 실행할 수 있습니다.
- "서비스 추가" 버튼을 클릭하면 `McpServiceDialog`가 팝업되어 서비스를 생성하거나 수정할 수 있습니다.

### 일반적인 작업 흐름
1. **서비스 생성**
   - "서비스 추가"를 클릭하고 이름과 설명을 입력한 후 전송 방식을 선택합니다.
   - SSE / HTTP Streamable은 접근 가능한 서비스 URL을 제공해야 하며, Stdio는 `uvx`/`npx` 명령과 인수를 구성해야 하고 환경 변수를 추가할 수 있습니다.
   - 필요에 따라 API Key, Bearer Token, 타임아웃 및 재시도 정책을 입력하고 저장하면 서비스가 목록에 나타납니다.
2. **서비스 시작/중지**
   - 목록의 스위치로 활성화 상태를 전환하면 시스템이 즉시 백엔드 `updateMCPService`를 호출하며, 실패 시 상태가 자동으로 롤백되고 알림이 표시됩니다.
3. **연결 테스트**
   - 더보기 메뉴에서 "테스트"를 선택하면 프론트엔드가 `/api/v1/mcp-services/{id}/test`를 호출하고 `McpTestResult`를 팝업합니다.
   - 성공 시 서비스에서 사용 가능한 도구 목록(입력 스키마 포함)과 리소스 목록을 표시하며, 실패 시 오류 메시지를 표시하여 네트워크 또는 인증 문제를 해결할 수 있습니다.
4. **편집 / 삭제**
   - "편집"을 선택하면 기존 구성을 불러오며, 수정 후 저장하면 됩니다.
   - "삭제"는 팝업 창에서 확인이 필요하며, 완료되면 목록이 자동으로 새로 고침됩니다.

### 사용 제안
- **전송 방식 선택**: 스트리밍 경험을 위해 SSE를 우선적으로 사용하세요. 표준 HTTP Streamable 호환성이 필요한 경우 전환하세요. 로컬 디버깅이나 오프라인 환경은 Stdio를 사용하고 동일한 시스템에서 MCP Server를 시작하는 것이 적합합니다.
- **인증 관리**: API Key / Token을 "인증 구성"에 저장하고, 프로덕션 환경에서는 최소 권한 Key를 별도로 생성하고 정기적으로 교체하는 것을 권장합니다.
- **재시도 정책**: 공용 네트워크 또는 타사 서비스의 경우 `retry_count`와 `retry_delay`를 적절히 높여 간헐적인 타임아웃으로 인해 Agent가 중단되는 것을 방지하세요.
